### On a city-wise basis, what is the analysis of returns?

## Query

```sql
SELECT
pa.CITY,
count(DISTINCT ri.RETURN_ID, ri.RETURN_ITEM_SEQ_ID) as TOTAL_RETURNS,
count(rsc.STATUS_ID) AS RETURN_COMPLETED_COUNT
FROM order_header oh
INNER JOIN order_item oi
ON oh.ORDER_ID = oi.ORDER_ID
INNER JOIN return_item ri
ON ri.ORDER_ID = oi.ORDER_ID AND ri.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID
LEFT JOIN return_status rsc
ON rsc.RETURN_ID = ri.RETURN_ID AND ri.RETURN_ITEM_SEQ_ID = rsc.RETURN_ITEM_SEQ_ID AND rsc.STATUS_ID = "RETURN_COMPLETED"
INNER JOIN return_contact_mech rcm
ON rcm.RETURN_ID = ri.RETURN_ID
INNER JOIN postal_address pa
ON pa.CONTACT_MECH_ID = rcm.CONTACT_MECH_ID
GROUP BY pa.CITY;
```

![image](https://github.com/coder-1304/Training-Assignment/assets/121802518/e72b0421-5704-4c02-9d39-883b83bd7b35)
